<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <link rel="manifest" href="/static/manifest.json" />
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("/static/service-worker.js")
          .then(() => console.log("Service Worker Registered"))
          .catch((error) =>
            console.error("Service Worker Registration Failed:", error)
          );
      }
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>運動分析</title>
     <style>
        * {
        box-sizing: border-box;
        font-family: 'Noto Sans TC', sans-serif;
        margin: 0;
        padding: 0;
        }

        :root{
        --page-max: 500px;   /* 內容最大寬 */
        --gutter: 16px;      /* 內容左右內距 */
        --side-gap: 36px;    /* 手機也保留左右灰底的總間距(兩側合計)，可調 20~32 */
        }

        body {
        background-color: #f4f4f4; /* ← 這裡換你想要的顏色 */
        margin: 0;
        padding-top: 70px;   /* ✅ 騰出跟 header 一樣的高度 */
        font-family: 'Noto Sans TC', sans-serif;
        }

        .header{
        position: fixed; 
        top:0; 
        left:0; 
        width:100%;
        display:flex; 
        align-items:center; 
        justify-content:flex-start;
        height:70px; background:#fff; 
        box-shadow:0 1px 6px rgba(0,0,0,.2); 
        z-index:1000;

        /* 上下固定，左右用計算讓內文邊線與 .container 一致 */
        padding-top:10px; 
        padding-bottom:10px;
        padding-left:  calc((100vw - min(var(--page-max), calc(100vw - var(--side-gap))))/2 + var(--gutter));
        padding-right: calc((100vw - min(var(--page-max), calc(100vw - var(--side-gap))))/2 + var(--gutter));
        }


        .back-button {
            background: none;
            border: none;
            cursor: pointer;
            margin-right: 12px;
        }

        .left-section {
            position: absolute;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 2;
        }

        .left-section svg {
            width: 24px;
            height: 24px;
            cursor: pointer;
            /* 預設深藍 */
            color: #2c4975; /* 柔和轉場（顏色＋位移都會順） */
            transition: color .25s ease, transform .25s ease;
        }

        .left-section svg:hover {
        /* 滑過變淺藍 */
        color: #81d3e1;
        /* 可選：微小位移讓互動更柔和，有需要就留著 */
        }

        .navbar-title {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            font-weight: bold;
            font-size: 20px;
            color: #2c4975;
        }

        .navbar-title img {
            height: 40px;
            margin-right: 5px;
            margin-top: 3px;
        }

        @media (max-width: 480px) {
            .navbar-title {
                font-size: 18px;
            }
        }

        .summary-item {
            flex: 1;
            text-align: center;
            position: relative;
            border-right: 2px solid white;  /* ✅ 用邊框做分隔線 */
        }

        .summary-item .number {
            font-size: 40px;
            font-weight: bold;
            color: white;
            text-align: center;
        }

        .summary-item .unit {
            font-size: 16px;
            color: white;
            text-align: center;
            font-weight: bold;
        }

        .summary-item .label {
            font-size: 14px;
            color: white;
            text-align: center;
            font-weight: bold;
        }

        .summary-item:last-child {
        border-right: none;  /* ✅ 最後一欄不需要線 */
        }
        .summary-divider {
            border: none;
            height: 2px;
            background-color: #81d3e1;
            margin: 0 0 20px;
            border-radius: 4px;
            opacity: 0.6;
        }
        /* ✅ 新增：主要容器 */
        .container{
        /* 小螢幕也預留左右灰底：用 (100vw - side-gap) 當上限 */
        width: min(var(--page-max), calc(100vw - var(--side-gap)));
        margin: 0 auto;
        min-height: calc(100vh - 70px);
        background:#fff;
   
        padding: 10px var(--gutter) 24px;
        box-sizing: border-box;
        }

        /* ✅ 修改：summary 在 container 內，不需要左右 40px 的外距 */
        .summary {
            display: flex;
            justify-content: space-around;
            background-color: #fea3a8;
            padding: 16px;
            border-radius: 12px;
            margin: 20px 0;   
            flex-wrap: nowrap; 
        }

        /* ✅ 768px 以下：只調整 summary 的外距，不動 container */
        @media (max-width: 768px) {
        .summary {
            margin: 16px 0;  /* 與 container 內距對齊 */
        }
        }
        /* ✅ 新增：手機也維持三欄橫排 */
        @media (max-width: 480px) {
        .summary {
            flex-direction: row;   /* 明確指定橫排 */
            gap: 0;                /* 手機版不留額外間距 */
            padding: 12px 10px;    /* 內距稍微縮小以塞下三欄 */
        }
        .summary-item { 
            flex: 1;               /* 三欄平均 */
            min-width: 0;
        }
        .summary-item .label { 
            font-size: 12px; 
            line-height: 1.3;
            white-space: nowrap;   /* 避免標題換行 */
        }
        .summary-item .number { 
            font-size: 32px;       /* 手機數字略小一點 */
        }
        .summary-item .unit   { 
            font-size: 12px; 
            font-weight: bold;
        }
        .summary-item:not(:last-child)::after{
            display: block;        /* 手機仍顯示白色分隔線 */
            height: 70%;           /* 分隔線稍短一點更好看 */
        }
        }


    </style>
    </head>
    <body>
        <div class="header">
            <div class="left-section">
                <svg
                id="back-button"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                width="24"
                height="24"
                >
                <path
                    d="M15 19l-7-7 7-7"
                    stroke="currentColor"
                    stroke-width="2"
                    fill="none"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                ></path>
                <path
                    d="M8 12h14"
                    stroke="currentColor"
                    stroke-width="2"
                    fill="none"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                ></path>
                </svg>
            </div>
            <div class="navbar-title">
                <img src="/static/logo.png" alt="Logo" />
                運動分析
            </div>
        </div>
        <div class="container">
        <div class="summary">
            <div class="summary-item">
                <div class="label">總參加活動<br>
                <div class="number"></div>次</div>
            </div>
            <div class="summary-item">
                <div class="label">累積時數<br>
                <div class="number"></div>小時</div>
            </div>
            <div class="summary-item">
                <div class="label">最常參與</div>
                <div class="number"></div>
                <div class="unit">次</div>
            </div>
        </div>
        <hr class="summary-divider" />
        </div>
        <script>
            document.getElementById("back-button").onclick = () => {
                history.back(); // 或者使用 location.href = 'member.html';
            };

            async function fetchUserActivityStats() {
                const urlParams = new URLSearchParams(window.location.search);
                const memberId = urlParams.get("member_id");
                if (!memberId) {
                    console.error("缺少 member_id");
                    return;
                }

                const response = await fetch(`/api/activities/user_activity_stats?member_id=${memberId}`);
                if (response.ok) {
                    const data = await response.json();
                    console.log("API 返回數據:", data); // 添加調試信息

                    document.querySelector(".summary-item:nth-child(1) .number").textContent = data.total_activities;
                    document.querySelector(".summary-item:nth-child(2) .number").textContent = data.total_duration_hours.toFixed(1);
                    document.querySelector(".summary-item:nth-child(3) .number").textContent = data.most_common_sport_count;
                    document.querySelector(".summary-item:nth-child(3) .label").textContent = `最常參與 - ${data.most_common_sport}`;


                }
            }

            fetchUserActivityStats();
        </script>
    </body>
</html>