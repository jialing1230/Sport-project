<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <link rel="manifest" href="/static/manifest.json" />
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("/static/service-worker.js")
          .then(() => console.log("Service Worker Registered"))
          .catch((error) =>
            console.error("Service Worker Registration Failed:", error)
          );
      }
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æˆ‘çš„æ´»å‹•</title>
    <style>
      /* è®“ padding ä¸æœƒæŠŠå…ƒç´ æ’çˆ†å¯¬åº¦ï¼Œé¿å…å‡ºç¾æ°´å¹³å·è»¸ */
      *, *::before, *::after { box-sizing: border-box; }

      :root {
        --primary-color: #64bcd0;
        --text-color: #2c4975;
        --fab-color: #fea3a8;
        --beige-color: #fdf9ed;
        --bg-color: #f5f5f5;
        --tab-bg: #ffffff;
        --word-color: black;
        --header-h: 66px;   /* tabs-container 64px + divider 2px */
        --bottom-h: 60px;   /* ä½ çš„ bottom-nav é«˜åº¦ */
        --card-w: 340px;
      }
      @media (max-width: 600px){
        :root{ --card-w: 320px; }  /* æ‰‹æ©Ÿå¡ç‰‡å¯¬ */
         .activity-card-container {
          grid-template-columns: 1fr;
          justify-items: center;      /* â† ç½®ä¸­ grid item */
        }
        .activity-card,
        .add-activity-card {
          width: var(--card-w);       /* ä¿ç•™å›ºå®šå¯¬ */
          max-width: 100%;
          justify-self: center;       /* grid è‡ªå·±ä¹Ÿç½®ä¸­ï¼ˆä¿éšªï¼‰ */
          margin: 0 auto;             /* block ç½®ä¸­ï¼ˆå†ä¿éšªï¼‰ */
        }
      }

      html, body{
        height: 100%;
        overflow: hidden;              /* é–ä½æ•´é å·è»¸ï¼Œåªè®“å…§å®¹å€æ»¾ */
      }
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        font-size: 16px;
      }

      .tabs-wrapper {
        background-color: var(--tab-bg);
        position: fixed;
        top: 0; left: 0; right: 0;
        z-index: 1200;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08); /* â­ tabså€åŸŸå¢åŠ å¾®é™°å½± */
      }

      .tabs-container {
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
        height: 64px; /* â­ç•¥æé«˜ */
      }

      .tab {
        flex: 1;
        text-align: center;
        line-height: 64px;
        font-size: 18px;
        font-weight: bold;
        letter-spacing: 0.5px;
        color: var(--text-color);
        cursor: pointer;
        background-color: var(--tab-bg);
        border: none;
        position: relative;
        overflow: hidden;
        transition: transform 0.2s ease;
      }

      /* Hoveræ•ˆæœï¼šå¾®ç¸®æ”¾ */
      .tab:hover {
        transform: scale(1.05);
      }

      /* é»æ“Šç‰¹æ•ˆ */
      .tab::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--primary-color);
        opacity: 0;
        transition: opacity 0.6s ease;
        pointer-events: none;
      }

      .tab:active::after {
        opacity: 0.4;
        transition: opacity 0.6s ease;
      }

      /* è¢«é¸ä¸­çš„Tabæ–‡å­—è®Šæ°´è—è‰² */
      .tab.active {
        color: var(--primary-color);
      }

      .divider {
        height: 2px;
        background: #e0e0e0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* â­å¾®åŠ æ·±é™°å½± */
        position: relative;
        z-index: 1;
      }

      .indicator {
        position: absolute;
        top: 0;
        height: 3px;
        background-color: var(--primary-color);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        transition: left 0.3s ease, width 0.3s ease;
        z-index: 2;
        border-radius: 2px;
      }

      /* æ‰‹æ©Ÿï¼šå·¦å³åªç•™ 12px */
      .tab-content {
        padding: 16px 18px;
        font-size: 24px;
        text-align: center;
        font-weight: 600;
        line-height: 1.8;
        letter-spacing: 0.5px;
      }


      /* FABæŒ‰éˆ• */
      .fab {
        position: fixed;
        bottom: 60px;
        right: 30px;
        width: 60px;
        height: 60px;
        background-color: var(--fab-color);
        color: var(--beige-color);
        border: none;
        border-radius: 50%;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        font-size: 30px;
        font-weight: bold;
        text-align: center;
        line-height: 60px;
        cursor: pointer;
        transition: background-color 0.3s, opacity 0.3s ease,
          transform 0.2s ease;
        opacity: 1;
        z-index: 1100;
      }

      .fab.hidden {
        opacity: 0;
        pointer-events: none;
      }

      .fab:hover {
        background-color: #f98d92;
        transform: scale(1.08); /* â­hoveræ™‚å¾®æ”¾å¤§ */
      }

      .fab:active {
        transform: scale(0.95); /* â­é»æ“Šæ™‚å¾®ç¸®å° */
      }

      /* æ‰‹æ©Ÿï¼šå¡ç‰‡æ’æ»¿æ¬„å¯¬ã€ä¸å†æœ‰é¡å¤–å·¦å³ç•™ç™½ */
      .activity-card-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 20px;
        justify-content: center;
        justify-items: stretch;   /* <- é—œéµï¼šæ’æ»¿ */
        padding: 0;               /* <- é¿å…å’Œ .tab-content é›™é‡ padding */
        margin: 0 auto;
        width: 100%;
      }

      .activity-card {
        background-color: #fff;
        border-radius: 8px;
        overflow: hidden;
        /* åˆå§‹é™°å½±ä¿æŒè¼•ä¸€äº› */
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
        width:  var(--card-w);
       
        padding: 20px;
        font-size: 16px;
        color: var(--text-color);
        /* åªåšé™°å½±çš„éæ¸¡ */
        transition: box-shadow 0.25s ease;
        position: relative;
        box-sizing: border-box;
        min-height: 220px;
        height: auto;         /* â† é¿å…è¢«æ‹‰åˆ°è·Ÿæ•´åˆ—ä¸€æ¨£é«˜ */
      }


      .label {
        color: var(--text-color);
        font-weight: bold;
      }

      .value {
        color: var(--word-color); /* é»‘è‰² */
        font-weight: normal;
      }

      .status-text {
        font-weight: normal;
        color: black; /* æ·±è—è‰²ï¼Œèˆ‡ä¸»é¡Œä¸€è‡´ */
        margin-right: 10px; /* èˆ‡æŒ‰éˆ•ä¿æŒé–“è· */
      }

      .activity-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); /* â­ è¼•å¾®åŠ æ·±é™°å½± */
      }


      .activity-card h3 {
        font-size: 24px;
        color: var(--primary-color);
      }

      .activity-card p {
        margin: 0px 0px;
        line-height: 1.5;
      }

      .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding-top: 20px;
        z-index: 1300;
        overflow: visible;
      }

      .modal-content {
        position: relative; /* ç¢ºä¿å­å…ƒç´ çš„çµ•å°å®šä½åŸºæ–¼æ­¤å®¹å™¨ */
        background-color: #fff;
        padding: 15px;
        border-radius: 8px;
        width: 80%; /* ä½¿ç”¨ç™¾åˆ†æ¯”å¯¬åº¦ */
        max-width: 400px; /* è¨­ç½®æœ€å¤§å¯¬åº¦ */
        height: auto; /* é«˜åº¦è‡ªé©æ‡‰å…§å®¹ */
        max-height: 90%; /* è¨­ç½®æœ€å¤§é«˜åº¦ */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        text-align: left;
        overflow: visible; /* é˜²æ­¢å…§å®¹æº¢å‡º */
      }

      .modal-content .scrollable-content {
        max-height: 80%; /* é™åˆ¶æ»¾å‹•å€åŸŸçš„é«˜åº¦ */
        overflow-y: auto; /* åƒ…åœ¨æ­¤å€åŸŸå•Ÿç”¨å‚ç›´æ»¾å‹• */
      }

      .modal-content h2 {
        margin-top: 0;
        color: var(--primary-color);
        text-align: center;
      }
      @media (max-width: 768px) {
        .modal-content {
          padding: 15px; /* æ¸›å°‘å…§é‚Šè· */
          border-radius: 8px; /* èª¿æ•´åœ“è§’ */
        }

        .modal-content h2 {
          font-size: 18px; /* ç¸®å°æ¨™é¡Œå­—é«” */
        }

        .participant-card {
          font-size: 14px; /* ç¸®å°åƒåŠ è€…å¡ç‰‡å­—é«” */
          padding: 8px 10px; /* æ¸›å°‘å…§é‚Šè· */
        }

        .participant-avatar {
          width: 30px; /* ç¸®å°é ­åƒå¤§å° */
          height: 30px;
        }

        .participants-list {
          max-height: 150px; /* é™åˆ¶åˆ—è¡¨é«˜åº¦ */
        }
      }

      /* é‡å°æ›´å°çš„è¢å¹•é€²è¡Œé€²ä¸€æ­¥å„ªåŒ– */
      @media (max-width: 480px) {
        .modal-content {
          padding: 10px; /* é€²ä¸€æ­¥æ¸›å°‘å…§é‚Šè· */
        }

        .modal-content h2 {
          font-size: 16px; /* å†æ¬¡ç¸®å°æ¨™é¡Œå­—é«” */
        }

        .participant-card {
          font-size: 12px; /* å†æ¬¡ç¸®å°åƒåŠ è€…å¡ç‰‡å­—é«” */
          padding: 5px 8px; /* æ¸›å°‘å…§é‚Šè· */
        }

        .participant-avatar {
          width: 25px; /* å†æ¬¡ç¸®å°é ­åƒå¤§å° */
          height: 25px;
        }

        .participants-list {
          max-height: 120px; /* é€²ä¸€æ­¥é™åˆ¶åˆ—è¡¨é«˜åº¦ */
        }
      }

      .close {
        position: absolute;
        top: -15px; /* å°‡æŒ‰éˆ•ç§»åˆ°å¡ç‰‡å¤– */
        right: -30px; /* å°‡æŒ‰éˆ•ç§»åˆ°å¡ç‰‡å¤– */
        font-size: 32px; /* æ”¾å¤§æŒ‰éˆ• */
        cursor: pointer;
        background-color: #fff; /* æ·»åŠ èƒŒæ™¯è‰²ï¼Œè®“æŒ‰éˆ•æ›´æ˜é¡¯ */
        border: 2px solid var(--primary-color); /* æ·»åŠ é‚Šæ¡† */
        border-radius: 50%; /* åœ“å½¢æŒ‰éˆ• */
        width: 40px; /* è¨­å®šå¯¬åº¦ */
        height: 40px; /* è¨­å®šé«˜åº¦ */
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* æ·»åŠ é™°å½± */
        transition: transform 0.2s ease, background-color 0.2s ease; /* æ·»åŠ éæ¸¡æ•ˆæœ */
        z-index: 100;
      }

      .close:hover {
        transform: scale(1.2); /* æ»‘é¼ æ‡¸åœæ™‚æ”¾å¤§ */
        background-color: #ff6b6b; /* æ”¹è®ŠèƒŒæ™¯è‰² */
        border-color: #ff6b6b !important;
        color: #fff; /* æ”¹è®Šæ–‡å­—é¡è‰² */
      }

      .close-button {
        position: absolute; /* çµ•å°å®šä½ï¼ŒåŸºæ–¼çˆ¶å®¹å™¨ .modal-content */
        bottom: 20px; /* è·é›¢æ¨¡æ…‹æ¡†åº•éƒ¨ 20px */
        left: 20px; /* è·é›¢æ¨¡æ…‹æ¡†å·¦å´ 20px */
        padding: 10px 20px;
        background-color: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.2s ease;
      }

      .close-button:hover {
        background-color: #4aa3b5;
      }
      .modal-tabs {
        display: flex;
        justify-content: center;
        position: relative;
        background-color: var(--tab-bg);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
      }

      .modal-tab {
        flex: 1;
        text-align: center;
        line-height: 50px;
        font-size: 18px;
        font-weight: bold;
        color: var(--text-color);
        cursor: pointer;
        background-color: var(--tab-bg);
        border: none;
        position: relative;
        transition: transform 0.2s ease, color 0.2s ease;
      }

      .modal-tab:hover {
        transform: scale(1.05);
      }

      .modal-tab.active {
        color: var(--primary-color);
      }

      .modal-divider {
        height: 2px;
        background: #e0e0e0;
        position: relative;
      }

      .modal-indicator {
        position: absolute;
        top: 0;
        height: 3px;
        background-color: var(--primary-color);
        transition: left 0.3s ease, width 0.3s ease;
        border-radius: 2px;
      }

      .modal-tab-content {
        display: none;
        padding: 20px;
        font-size: 16px;
        color: var(--text-color);
      }

      .modal-tab-content.active {
        display: block;
      }

      .modal-tab-content h3 {
        margin-top: 5px; /* èª¿æ•´ä¸Šæ–¹é–“è·ï¼Œè®“æ¨™é¡Œæ›´é ä¸Š */
        margin-bottom: 10px; /* èª¿æ•´ä¸‹æ–¹é–“è· */
        font-size: 18px; /* ç¢ºä¿å­—é«”å¤§å°é©ä¸­ */
        color: #2c4975; /* æ·±è—è‰²ï¼Œèˆ‡ä¸»é¡Œä¸€è‡´ */
        font-weight: bold; /* åŠ ç²—å­—é«”ï¼Œè®“æ¨™é¡Œæ›´çªå‡º */
      }

      .participants-container {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-top: 5px;
      }

      .participant-card {
        display: flex;
        align-items: center;
        padding: 10px 15px;
        background-color: #f9f9f9;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        font-size: 16px;
        color: var(--text-color);
      }

      .participant-card.organizer {
        background-color: #e8f5e9;
        font-weight: bold;
      }

      .participant-card span {
        margin-left: 10px;
        color: var(--primary-color);
      }

      .participant-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
        margin-right: 10px;
      }

      .participant-card img {
        margin-right: 10px;
      }

      .participants-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
        max-height: 200px; /* é™åˆ¶é«˜åº¦ */
        overflow-y: auto; /* æ»¾å‹•æ¢ */
        padding-right: 10px; /* å¢åŠ å…§é‚Šè·ï¼Œé¿å…æ»¾å‹•æ¢é®ä½å…§å®¹ */
      }

      .participants-list::-webkit-scrollbar {
        width: 8px; /* æ»¾å‹•æ¢å¯¬åº¦ */
      }

      .participants-list::-webkit-scrollbar-thumb {
        background-color: var(--primary-color); /* æ»¾å‹•æ¢é¡è‰² */
        border-radius: 4px; /* åœ“è§’ */
      }

      .participants-list::-webkit-scrollbar-track {
        background-color: #f0f0f0; /* æ»¾å‹•æ¢èƒŒæ™¯ */
      }

      #evaluateModal .modal-content {
        width: 400px;
        height: auto;
        padding: 20px;
        border-radius: 8px;
        background-color: #fff;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        text-align: center;
      }

      #evaluateModal textarea {
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 10px;
        font-size: 16px;
      }

      #evaluateModal .submit-button {
        padding: 10px 20px;
        background-color: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
      }

      #evaluateModal .submit-button:hover {
        background-color: #4aa3b5;
      }

      .status-text {
        font-weight: normal;
        color: black; /* æ·±è—è‰²ï¼Œèˆ‡ä¸»é¡Œä¸€è‡´ */
        margin-right: 10px; /* èˆ‡æŒ‰éˆ•ä¿æŒé–“è· */
      }


      .evaluate-button {
        display: inline-flex;
        align-items: center;
        background: none; /* ç§»é™¤èƒŒæ™¯ */
        border: none; /* ç§»é™¤é‚Šæ¡† */
        padding: 0; /* ç§»é™¤å…§é‚Šè· */
        cursor: pointer;
      }

      .evaluate-icon {
        width: 24px; /* åœ–æ¨™å¯¬åº¦ */
        height: 24px; /* åœ–æ¨™é«˜åº¦ */
        transition: transform 0.2s ease;
      }

      .evaluate-button:hover .evaluate-icon {
        transform: scale(1.2); /* æ»‘é¼ æ‡¸åœæ™‚æ”¾å¤§ */
      }
      .bottom-bar-button {
        background: none;
        border: none;
        padding: 5px 0;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .bottom-bar-label {
        font-size: 12px;
        color: #2c4975;
        margin-top: 4px;
      }
      button[onclick^="cancelParticipation"] {
        width: 10px; /* å¢åŠ æŒ‰éˆ•å¯¬åº¦ */
        height: 10px; /* å¢åŠ æŒ‰éˆ•é«˜åº¦ */
        background: none;
        border: none;
        cursor: pointer;
        position: absolute;
        top: 10px;
        right: 10px;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      button[onclick^="cancelParticipation"] img {
        width: 100%; /* åœ–æ¨™å¡«æ»¿æŒ‰éˆ• */
        height: 100%;
        transition: transform 0.2s ease; /* æ·»åŠ å¹³æ»‘éæ¸¡æ•ˆæœ */
      }

      button[onclick^="cancelParticipation"]:hover img {
        transform: scale(1.2); /* æ»‘é¼ æ‡¸åœæ™‚æ”¾å¤§ */
      }

      .action-button {
        background: none; /* ç§»é™¤æŒ‰éˆ•èƒŒæ™¯ */
        border: none; /* ç§»é™¤æŒ‰éˆ•é‚Šæ¡† */
        padding: 0; /* ç§»é™¤å…§é‚Šè· */
        cursor: pointer; /* è¨­ç½®ç‚ºå¯é»æ“Š */
      }

      .action-button img {
        width: 24px; /* è¨­å®šåœ–ç‰‡å¤§å° */
        height: 24px;
        border-radius: 50%; /* ç¢ºä¿åœ–ç‰‡ç‚ºåœ“å½¢ */
        transition: transform 0.2s ease; /* æ·»åŠ å¹³æ»‘éæ¸¡æ•ˆæœ */
      }

      .action-button img:hover {
        transform: scale(1.2); /* æ»‘é¼ æ‡¸åœæ™‚æ”¾å¤§ */
      }

      .action-button img:active {
        transform: scale(0.9); /* æŒ‰ä¸‹æ™‚ç¸®å° */
      }
      .bottom-nav {
        display: flex;
        justify-content: space-around;
        align-items: center;
        height: 60px;
        background-color: #fff;
        border-top: 1px solid #ccc;
        position: fixed;      /* âœ… æ”¹æˆå›ºå®šå®šä½ */
        bottom: 0;            /* âœ… è²¼é½Šç•«é¢åº•éƒ¨ */
        left: 0;
        right: 0;
        z-index: 1000;        /* âœ… ç¢ºä¿æµ®åœ¨æœ€ä¸Šå±¤ */
        box-shadow: 0 -2px 6px rgba(0, 0, 0, 0.05);
      }

      .bottom-item {
        flex: 1;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        text-decoration: none;
        transition: transform 0.2s ease;
        z-index: 1;
        border: none;         /* âœ… ç§»é™¤é‚Šæ¡† */
        outline: none;        /* âœ… ç§»é™¤é»æ“Šæ™‚çš„å¤–æ¡† */
        background-color: #ffffff;
      }

      .bottom-item svg {
        fill: #2c4975;
        transition: fill 0.3s ease, transform 0.3s ease;
        width: 26px;
        height: 28px;
        position: relative;
      }

      .bottom-item.active svg {
        fill: #64bcd0;
        transform: translateY(0px);
      }

      .item-label {
        font-size: 12px;
        color: #2c4975;
        height: 0;
        overflow: hidden;
        opacity: 0;
        transition: all 0.3s ease;
      }

      .bottom-item.active .item-label {
        height: 16px;
        opacity: 1;
        margin-top: 0px;
        color: #64bcd0;
      }

      .ripple {
        position: absolute;
        border-radius: 50%;
        background-color: rgba(129, 211, 225, 0.35);
        transform: scale(0);
        animation: ripple-animation 0.9s cubic-bezier(0.4, 0, 0.2, 1);
        pointer-events: none;
        z-index: 0;
      }

      @keyframes ripple-animation {
        to {
          transform: scale(2.5);
          opacity: 0;
        }
      }
      /* ä¸­é–“å…§å®¹å€ï¼šç”¨æ•´å€‹è¦–çª—å‰©é¤˜é«˜åº¦ï¼Œè‡ªå·±æ»¾å‹• */
      #tabContents{
        position: fixed;
        top: var(--header-h);
        left: 0; right: 0;
        bottom: var(--bottom-h);
        overflow: auto;
        -webkit-overflow-scrolling: touch;  /* iOS æ…£æ€§æ»¾å‹• */
        background: var(--bg-color);
        /* å¦‚æœä½ æœ‰å·¦å³å…§è·æ§åˆ¶ï¼Œç•™è‘—åŸæœ¬çš„ .tab-content è¦å‰‡å³å¯ */
      }
      /* iPhone ç€æµ·å®‰å…¨å€ï¼ˆå¯é¸ï¼‰ */
      @supports(padding:max(0px)){
        #tabContents{ bottom: calc(var(--bottom-h) + env(safe-area-inset-bottom)); }
        .bottom-nav{ padding-bottom: env(safe-area-inset-bottom); }
      }
      #activityTypeModal {
        display: none;
        position: fixed;
        z-index: 1200;
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        background-color: rgba(0, 0, 0, 0.4);
        justify-content: center;
        align-items: flex-end; /* æ”¹ç‚ºåº•éƒ¨å°é½Š */
        transition: background-color 0.3s ease;
      }

      #activityTypeModal.show {
        display: flex;
      }

      .activity-type-box {
        background-color: #fff;
        border-top-left-radius: 20px;
        border-top-right-radius: 20px;
        padding: 24px 16px;
        width: 100%;
        max-width: 420px;
        text-align: center;
        position: relative;
        box-shadow: 0 -4px 16px rgba(0, 0, 0, 0.2);
        transform: translateY(100%);
        animation: slideUp 0.3s ease-out forwards;
      }
      .activity-type-box::after {
        content: "";
        position: absolute;
        bottom: -20px;   /* â¬…ï¸ å»¶ä¼¸ä¸€å¡Šç™½è‰²åˆ°ä¸‹æ–¹ */
        left: 0;
        right: 0;
        height: 20px;
        background: #fff;
      }

      @supports(padding:max(0px)){
        .activity-type-box {
          bottom: calc(16px + env(safe-area-inset-bottom));
        }
      }

      @keyframes slideUp {
        to {
          transform: translateY(0%);
        }
      }

      .activity-type-title {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 24px;
        font-size: 18px;
        font-weight: bold;
        color: var(--text-color);
      }

      .activity-type-title svg {
        margin-left: 6px;
        width: 18px;
        height: 18px;
        stroke: var(--primary-color);
        stroke-width: 2;
      }

      .activity-type-options {
        display: flex;
        gap: 32px;
        justify-content: center;
      }

      .activity-type-btn {
        border: none;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        padding: 16px;
        width: 120px;
        display: flex;
        flex-direction: column;
        align-items: center;
        transition: none;
        cursor: pointer;
        position: relative;
        font-weight: 600;
      }

      .activity-type-btn:hover {
        transform: none;
      }

      .activity-type-btn svg {
        width: 36px;
        height: 36px;
        stroke: var(--text-color);
        margin-bottom: 8px;
        position: relative;
        z-index: 1;
        display: block;
      }

      .activity-type-btn div {
        color: var(--text-color);
        font-weight: bold;
      }
      /* é–å®šç‹€æ…‹ï¼šæŠŠå¡ç‰‡å…§å®¹æ·¡åŒ–ï¼‹å»è‰²ï¼ˆè† å›Šä¸å—å½±éŸ¿ï¼‰ */
      .activity-type-btn.is-locked > :not(.lock-pill){
        opacity: .55;
        filter: grayscale(1);
      }


      /* ä»˜è²»è† å›Šï¼ˆåªä¿ç•™é€™ä¸€ä»½ï¼‰ */
      .activity-type-btn .lock-pill{
        position: absolute;
        top: 36px;
        left: 12px;
        font-size: 12px;
        color: #2c4975;
        background: #fff;
        border: 1px solid rgba(44,73,117,.15);
        border-radius: 999px;
        padding: 3px 10px;
        box-shadow: 0 2px 6px rgba(0,0,0,.08);
        pointer-events: none;        /* ä¸é˜»æ“‹é»æ“Š */
        white-space: nowrap;
        z-index: 3;
        transition: background-color .2s ease, color .2s ease, border-color .2s ease;
      }
      /* æœªé–‹é€šï¼šæ»‘éå¡ç‰‡æ™‚ï¼Œåªæœ‰è† å›Šåè½‰é¡è‰² */
      .activity-type-btn.is-locked:hover .lock-pill,
      .activity-type-btn.is-locked:focus-visible .lock-pill,
      .activity-type-btn.is-locked:active .lock-pill{
        background: #2c4975;
        color: #fff;
        border-color: #2c4975;
      }
      .custom-card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: -8px;
        margin-bottom: 6px;
      }
      .custom-card-title {
        font-size: 28px !important;
        font-weight: bold;
        color: #2c4975 !important;
        margin: 0;
      }
      .status-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        font-weight: bold;
        letter-spacing: 1px;
        padding: 7px 10px 4px 10px;   /* â†‘ top å¤šä¸€é» â†“ bottom å°‘ä¸€é» */
        border-radius: 8px;
        color: white;
        background-color: #fda7a8;
        line-height: 1;
        min-width: 60px;
      
      }
      .custom-card-info {
        color: #2c4975;
        margin: 4px 0 8px;
        text-align: left;
        margin-top: -10px !important;
        padding-bottom: 6px;
        font-weight: normal; 
        border-bottom: 1px solid #64bcd0;
        width: 100%; /* ç¢ºä¿æ©«ç·šèƒ½å±•é–‹æ•´å€‹å€å¡Š */
        display: block; /* ç¢ºä¿æ¨£å¼å¯è¢«æ¸²æŸ“ */
         margin-bottom: 15px !important;
        
        
        
      }
      .custom-card-icon-line {
         font-weight: normal; 
         display: flex;
         align-items: center;       /* âœ… åœ–ç¤ºèˆ‡æ–‡å­—å‚ç›´ç½®ä¸­ */
         gap: 6px;                  /* âœ… åœ–ç¤ºèˆ‡æ–‡å­—é–“è· */
         margin: 4px 0;
         justify-content: flex-start; /* âœ… å…§å®¹é å·¦å°é½Š */
         margin-top: 10px !important;
      }
      /* å–®è¡Œçœç•¥è™Ÿ */
      .truncate-1 {
        flex: 1;           /* è®“å®ƒæ’æ»¿å‰©é¤˜ç©ºé–“ */
        min-width: 0;      /* âœ… é—œéµï¼Œæ²’æœ‰é€™å€‹ ellipsis ä¸æœƒç”Ÿæ•ˆ */
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
      }
      /* æ´»å‹•é¡å‹æ¨£å¼ï¼šå…±ç”¨è¨­å®š */
      .activity-type {
        font-size: 13px;
        margin-left: 8px;
        vertical-align: middle;
      }

      /* å¦‚æœæ˜¯è¨“ç·´èª²ç¨‹ï¼šåŠ åº•æ¡† */
      .activity-type.training {
        background-color: #2c4975;
        color: white;
        font-weight: bold;
        border-radius: 10px;
        padding: 4px 10px;
        display: inline-block;
      }

      /* å¦‚æœæ˜¯ä¸€èˆ¬æ´»å‹•ï¼šåªæœ‰æ–‡å­— */
      .activity-type.general {
        color: #2c4975;
        font-weight: normal;
        padding: 0;
        background: none;
      }
      @media (min-width: 768px) {
        .tab-content { padding: 20px 16px; }
        .activity-card-container { gap: 24px; }
      }

    /* æ¡Œæ©Ÿï¼šå¡ç‰‡å›ºå®šå¯¬ 340pxï¼Œèƒ½æ”¾å¹¾å¼µå°±æ”¾å¹¾å¼µï¼Œè‡ªå‹•æ›è¡Œï¼Œä¸æ‹‰ä¼¸ */
    @media (min-width: 1024px) {
      .tab-content {
        max-width: min(1600px, 100% - 64px);
        margin: 0 auto;
        padding: 20px 0;
      }

      .activity-card-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(var(--card-w), var(--card-w)));
        /* â†‘ æ¯æ¬„å¯¬å°±æ˜¯å¡ç‰‡å¯¬ï¼Œç€è¦½å™¨è‡ªå‹•è¨ˆç®—èƒ½æ“ºå¹¾æ¬„ï¼›ä¸å¤ å°±æ›è¡Œ */
        gap: 32px;
        justify-content: center; /* æ•´æ’ç½®ä¸­ï¼ˆå·¦å³æœƒç•™å‡ç­‰ç©ºç™½ï¼‰ */
        justify-items: center;   /* æ¯å¼µå¡åœ¨æ¬„å…§ç½®ä¸­ */
      }

      .activity-card,
      .add-activity-card {
        width: var(--card-w);     /* å›ºå®šå¯¬ */
        max-width: var(--card-w); /* ä¸è¢«æ’å¤§ */
        /* ä¸è¦å†å¯« width:100% / max-width:none */
      }
    }

      /* â­ 1440px ä»¥ä¸Šé¡¯ç¤ºå››æ¬„ï¼ˆ340px å¡ç‰‡ + 20px é–“è·å‰›å¥½ï¼‰ */
      @media (min-width: 1440px) {
        .activity-card-container {
          grid-template-columns: repeat(4, 1fr);
          max-width: 1600px;      /* 4*340 + 3*20 = 1420ï¼Œè®“æ•´æ’ç½®ä¸­å¥½çœ‹ */
          margin: 0 auto;         /* ç½®ä¸­å®¹å™¨ */
        }

      }
      /* è®“æ–°å¢å¡ç‰‡èˆ‡æ´»å‹•å¡ç‰‡åŒæ¡†æ¶ */
      .add-activity-card {
        border: 2px dashed var(--primary-color);
        background-color: transparent;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 220px;    /* è·Ÿä¸€èˆ¬å¡ç‰‡ä¸€è‡´ */
        box-shadow: none;     /* æ‹¿æ‰é™°å½± */
        cursor: pointer;
        height: auto;      /* â† ç”±å…§å®¹æ±ºå®šé«˜åº¦ */
        align-self: start; /* â† å³ä½¿æ•´åˆ—å¾ˆé«˜ï¼Œï¼‹å¡ç‰‡è‡ªå·±ç¶­æŒæ­£å¸¸é«˜åº¦ */
      }

      /* ï¼‹ç¬¦è™Ÿæ¨£å¼ */
      .add-activity-card .plus-sign {
        font-size: 48px;
        font-weight: bold;
        color: var(--primary-color);
        line-height: 1;
      }
      /* å¹³æ¿ï¼š601â€“1023pxï¼Œå…©æ¬„ç½®ä¸­ */
      @media (min-width: 601px) and (max-width: 1023px) {
        .activity-card-container {
          grid-template-columns: repeat(2, minmax(0, 1fr)); /* å…©æ¬„ */
          gap: 24px;                  /* å¡ç‰‡é–“è·ï¼Œå¯èª¿æ•´ */
          justify-items: center;      /* æ¯å€‹ item åœ¨æ ¼å­å…§ç½®ä¸­ */
        }

        .activity-card,
        .add-activity-card {
          width: var(--card-w);       /* å›ºå®šå¯¬åº¦ï¼ˆ340pxï¼‰ */
          max-width: 100%;
          justify-self: center;       /* grid è‡ªå·±ä¹Ÿç½®ä¸­ */
          margin: 0 auto;             /* å†ä¿éšª */
        }
      }
      .custom-card-icon-line span {
        white-space: nowrap;
        overflow-x: auto;
        display: inline-block;
      }
      /* è®“åƒ¹æ ¼å€å¡Šæ¢å¾©ç‚º flex ä¸¦æ”¹æˆä¸Šä¸‹æ’ */
      .custom-card-icon-line .price-and-tag { 
        display: flex; 
        align-items: center; 
        gap: 12px; 
      }

      .custom-card-icon-line .price-wrapper {
        display: flex !important;
        flex-direction: column;
        align-items: flex-start;
        line-height: 1.2;
        white-space: normal !important; /* ä¸è¦è¢«ä¸Šé¢é‚£æ¢ nowrap å½±éŸ¿ */
        overflow: visible !important;   /* ä¸è¦å‡ºç¾æ©«å‘æ²è»¸ */
      }

      /* åƒ¹æ ¼å…§çš„å…©è¡Œå„è‡ªæˆä¸€è¡Œ */
      .custom-card-icon-line .price-wrapper .original-price,
      .custom-card-icon-line .price-wrapper .discount-price {
        display: block;
      }

      /* è¨“ç·´èª²ç¨‹ */
      .custom-card-tag.training {
        background-color: #2c4975;
        color: #fff;
        
        border-radius: 0px;
        padding:3px 10px 1px 10px;
        display: inline-block;
      }

      /* ä¸€èˆ¬æ´»å‹•ï¼šç¶­æŒåŸæœ¬æ¨£å¼ */
      .custom-card-tag.general {
        color: #2c4975;
        background: transparent;
      }
      /* è®“å¡ç‰‡èƒ½æ”¾è† å›Š */
      .activity-type-btn { position: relative; }


      /* æœ‰äº› SVG ç”¨ currentColorï¼Œå¼·åˆ¶çµ¦é¡è‰² */
      .activity-type-btn{ color: var(--text-color); }
      .activity-type-btn svg path,
      .activity-type-btn svg rect,
      .activity-type-btn svg circle,
      .activity-type-btn svg polygon {
        fill: var(--text-color);   /* è‹¥ä½ æƒ³æ²¿ç”¨æ·±è—å°±ç”¨é€™å€‹ */
        /* æˆ–æƒ³å›ºå®šè‰²ï¼šfill:#2c4975; */
      }
      /* åªé‡å°å‡ç´šæç¤ºé€™å€‹ modalï¼šç½®ä¸­ã€å±¤ç´šæ›´é«˜ */
      #upgradeModal{
        z-index: 1400;        /* ä¸€å®šè“‹é #activityTypeModal(1200) */
        align-items: center;  /* å‚ç›´ç½®ä¸­ */
      }

      /* å‡ç´šæç¤ºçš„ç™½å¡ç‰‡ */
      #upgradeModal .modal-content{
        width: 300px;
        max-width: calc(100% - 48px);
        padding: 1px 16px 16px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 8px 24px rgba(0,0,0,.2);
      }

      /* å‡ç´šæç¤ºä¸è¦å³ä¸Šè§’å‰å‰ */
      #upgradeModal .close{ display:none; }

      /* å°è©±æ¡†ç‰ˆå‹ï¼ˆä¹‹å¾Œåˆ¥çš„å½ˆçª—ä¹Ÿèƒ½é‡ç”¨ï¼‰ */
      .dialog-title{
        margin-bottom: 16px;
        font-size: 20px;
        font-weight: bold;
        color: #2c4975;
        letter-spacing: .5px;
      }
      .dialog-desc{
        margin: 8px 0 18px;
        font-size: 14px;
        color: #000;
        line-height: 1.7;
        font-weight: 300;  /* â† æ”¹ç´°å­— */
      }
      .dialog-actions{
        display:flex;
        justify-content:center;
        gap: 40px;
      }
      .btn{
        padding: 8px 16px;
        border-radius: 6px;
        font-weight: 700;
        border: 2px solid transparent;
        cursor: pointer;
        transition: transform .18s ease, filter .28s ease, box-shadow .35s ease;
      }
      .btn:active{ transform: scale(.98); }
      .btn-outline-pink{
        background: #fff;
        color: var(--fab-color);
        border-color: var(--fab-color);
      }

      .btn-pink{
        background: var(--fab-color);
        color: #fff;
      }
      .btn-pink:hover{ filter: brightness(.95); }

      /* ä¿éšªï¼šé–å®šæ™‚ï¼Œä¸è¦æœ‰æ”¾å¤§æˆ–è®Šè‰²ï¼ˆå¡ç‰‡ä¿æŒåŸæ¨£ï¼‰ */
      .activity-type-btn.is-locked:hover,
      .activity-type-btn.is-locked:active{
        transform: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      }
      /* hover æ™‚æ‰å‡ºç¾é™°å½± */
      .btn-outline-pink:hover,
      .btn-pink:hover {
        box-shadow: 0 3px 8px rgba(0,0,0,0.12);
        transform: translateY(-1px); /* å¯é¸ï¼šç¨å¾®æµ®èµ· */
      }
      /* åªé‡å° æ´»å‹•é¡å‹èªªæ˜ çš„å½ˆçª—åšæ–°æ¨£å¼ */
      #typeInfoModal{
        display: none;             /* é è¨­éš±è—ï¼ˆç”¨ JS é¡¯ç¤ºï¼‰ */
        align-items: center !important;   /* å‚ç›´ç½®ä¸­ */
        justify-content: center !important; /* æ°´å¹³ç½®ä¸­ */
        padding-top: 0 !important; /* æ‹¿æ‰ä¸Šæ–¹ padding */
        z-index: 1350;             /* æ¯”åº•éƒ¨æŠ½å±œæ›´ä¸Šå±¤ä¸€é»ï¼ˆçœ‹ä½ éœ€æ±‚å¯èª¿ï¼‰ */
      }

      /* å¡ç‰‡æ¨£å¼ï¼ˆèˆ‡ upgrade åˆ†é–‹ï¼‰ */
      #typeInfoModal .modal-content{
        width: 320px;
        max-width: calc(100% - 48px);
        padding: 16px 16px 64px;  /* åº•éƒ¨å¤šç•™ç©ºé–“æ”¾é—œé–‰æŒ‰éˆ• */
        border-radius: 10px;
        text-align: left;
        position: relative;       /* è®“é—œé–‰éˆ•å¯ä»¥çµ•å°å®šä½åˆ°åº•éƒ¨ç½®ä¸­ */
        box-shadow: 0 8px 24px rgba(0,0,0,.18);
      }

      /* ä¸è¦å³ä¸Šè§’å‰å‰ */
      #typeInfoModal .close{ display:none !important; }

      /* å…§å®¹æ»¾å‹•é«˜åº¦ï¼ˆé¿å…è¢«åº•éƒ¨é—œé–‰éˆ•é®ä½ï¼‰ */
      #typeInfoModal .scrollable-content{
        max-height: 50vh;
        overflow-y: auto;
        padding-right: 4px;
      }

      /* åº•éƒ¨é—œé–‰æŒ‰éˆ• */
      #typeInfoModal .modal-close-btn{
        position: absolute;
        left: 50%;
        bottom: 14px;
        transform: translateX(-50%);
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        background: var(--primary-color);
        color: #fff;
        font-weight: 700;
        cursor: pointer;
        transition: transform .18s ease, box-shadow .35s ease, filter .28s ease;
      }
      #typeInfoBtn {
        cursor: pointer;
      }

      /* æ´»å‹•é¡å‹èªªæ˜ Modalï¼šæ¨™é¡Œã€å…§æ–‡ã€æ¨™ç±¤çµ±ä¸€æ’ç‰ˆ */
      #typeInfoModal h2 {
        text-align: center;
        margin: 8px 0 2px;
        font-size: 18px;
        font-weight: 700;
        color: var(--text-color); /* æ°´è—è‰²æ¨™é¡Œ */
      }

      #typeInfoModal h3 {
        font-size: 16px;
        font-weight: 600;
        color: var(--primary-color); /* æ·±è— */
        margin: 10px 0 6px;
      }

      #typeInfoModal .info-tag {
        font-size: 12px;
        color: #4aa3b5;   /* æ·ºè—æç¤º */
        font-weight: normal;
      }

      #typeInfoModal ul {
        margin: 0 0 6px 20px; /* å·¦é‚Šç¸®é€² */
        padding: 0;
        color: #2c4975;
        line-height: 1.7;
      }

      #typeInfoModal li {
        margin-bottom: 4px;
        font-size: 14px;
      }

      /* é—œé–‰æŒ‰éˆ• */
      #typeInfoModal .modal-close-btn {
        display: block;
        margin: 10px auto;  /* ç½®ä¸­ */
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        background:#81d3e1;
        color: #fff;
        font-weight: 700;
        cursor: pointer;
      }

      #typeInfoModal .modal-close-btn:hover {
        background: #2c4975; 
      }
      #typeInfoModal .scrollable-content {
        padding-left: 18px;  /* å·¦é‚ŠåŠ  12px */
      }
      /* å³ä¸Šè§’ã€Œå„ªæƒ ã€æŠ˜è§’ */
      .discount-corner {
        position: absolute;
        right: 0;
        bottom: 0;
        width: 0;
        height: 0;
        border-left: 50px solid transparent;   /* å·¦é‚Šé€æ˜ */
        border-bottom: 50px solid #ddd;     /* ä¸‹é‚Šç´…è‰²æŠ˜è§’ */
        z-index: 2;
        
        
      }

      .discount-corner__icon{
        position: absolute;
        right: 6px;        /* å¾€å³è²¼ä¸€é» */
        bottom: -45px;     /* å› ç‚ºæ˜¯ä¸‹é‚Šä¸‰è§’ï¼ŒY éœ€è¦æ˜¯è² å€¼è®“åœ–ç¤ºè½åœ¨ä¸‰è§’è£¡ */
        width: 20px;
        height: 20px;
        display: block;
        pointer-events: none;
        /* å¦‚æœä¸æ˜¯æé‚Šè·¯å¾‘è€Œæ˜¯å¡«è‰²åœ–ï¼Œå¯ç”¨ fill: #fff; */
      }
      .price-and-tag {
        display: flex;
        align-items: center;   /* å‚ç›´ç½®ä¸­ï¼Œè®“åƒ¹æ ¼å’Œæ¨™ç±¤æ’é½Š */
        gap: 12px;             /* åƒ¹æ ¼å’Œæ¨™ç±¤çš„é–“è· */
      }

      .price-wrapper {
        display: flex;
        flex-direction: column;  /* ğŸ‘ˆ å‚ç›´æ’åˆ—ï¼šåŸåƒ¹åœ¨ä¸Šï¼Œå„ªæƒ åƒ¹åœ¨ä¸‹ */
        align-items: flex-start; /* é å·¦å°é½Š */
        line-height: 1.2;
      }

      .original-price {
        text-decoration: line-through;
        color: #999;
        font-size: 14px;
      }

      .discount-price {
        font-weight: bold;
        color: #fe8a90;
        font-size: 16px;
      }






    </style>
  </head>

  <body>
    <div class="tabs-wrapper">
      <div class="tabs-container" id="tabs">
        <div class="tab active" onclick="switchTab(0)">æˆ‘ç™¼èµ·çš„æ´»å‹•</div>
        <div class="tab" onclick="switchTab(1)">æˆ‘åƒåŠ çš„æ´»å‹•</div>
      </div>
      <div class="divider">
        <div id="indicator" class="indicator" style="width: 50%; left: 0"></div>
      </div>
    </div>

    <div id="tabContents">
      <div class="tab-content" id="content-0">
        <div id="my-activities">è¼‰å…¥ä¸­...</div>
      </div>
      <div class="tab-content" id="content-1" style="display: none">
        å°šæœªåƒåŠ ä»»ä½•æ´»å‹•
      </div>
    </div>


    <!-- æ–°å¢æ´»å‹•å¡ç‰‡æ¨£å¼çš„æŒ‰éˆ• -->

    <div class="bottom-nav">
      <!-- åœ°åœ– -->
      <button class="bottom-item">
        <svg xmlns="http://www.w3.org/2000/svg" width="96" height="96" fill="#000000" viewBox="0 0 256 256">
            <path d="M108,80a20,20,0,1,1,20,20A20,20,0,0,1,108,80ZM60,80a68,68,0,0,1,136,0c0,62.25-59.51,97-62.05,98.42a12,12,0,0,1-11.9,0C119.51,177,60,142.25,60,80Zm24,0c0,38.2,30.71,64.2,44,73.64C141.21,144.15,172,118,172,80a44,44,0,0,0-88,0Zm124.57,65.6a12,12,0,1,0-9.14,22.19C213.56,173.61,220,180.27,220,184c0,4-7.13,11.07-22.77,17.08-18.3,7-42.89,10.92-69.23,10.92s-50.93-3.88-69.23-10.92C43.12,195.07,36,188,36,184c0-3.73,6.44-10.39,20.57-16.21a12,12,0,1,0-9.14-22.19C31.27,152.25,12,164.31,12,184c0,34.14,58.36,52,116,52,29.22,0,56.86-4.44,77.85-12.52C220.1,218,244,205.59,244,184,244,164.31,224.73,152.25,208.57,145.6Z"></path>
        </svg>
        <div class="item-label">åœ°åœ–</div>
      </button>

      <!-- æ´»å‹• -->
      <button class="bottom-item active">
        <svg xmlns="http://www.w3.org/2000/svg" width="96" height="96" fill="#000000" viewBox="0 0 256 256">
            <path d="M208,28H188V24a12,12,0,0,0-24,0v4H92V24a12,12,0,0,0-24,0v4H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V48A20,20,0,0,0,208,28ZM68,52a12,12,0,0,0,24,0h72a12,12,0,0,0,24,0h16V76H52V52ZM52,204V100H204V204Zm92-76a16,16,0,1,1-16-16A16,16,0,0,1,144,128Zm48,0a16,16,0,1,1-16-16A16,16,0,0,1,192,128ZM96,176a16,16,0,1,1-16-16A16,16,0,0,1,96,176Zm48,0a16,16,0,1,1-16-16A16,16,0,0,1,144,176Zm48,0a16,16,0,1,1-16-16A16,16,0,0,1,192,176Z"></path>
        </svg>
        <div class="item-label">æ´»å‹•</div>
      </button>

      <!-- âœ… é€šçŸ¥ï¼‰ -->
      <button class="bottom-item" id="notificationBtn" style="position:relative;">
        <svg xmlns="http://www.w3.org/2000/svg" width="96" height="96" fill="#000000" viewBox="0 0 256 256"><path d="M225.29,165.93C216.61,151,212,129.57,212,104a84,84,0,0,0-168,0c0,25.58-4.59,47-13.27,61.93A20.08,20.08,0,0,0,30.66,186,19.77,19.77,0,0,0,48,196H84.18a44,44,0,0,0,87.64,0H208a19.77,19.77,0,0,0,17.31-10A20.08,20.08,0,0,0,225.29,165.93ZM128,212a20,20,0,0,1-19.6-16h39.2A20,20,0,0,1,128,212ZM54.66,172C63.51,154,68,131.14,68,104a60,60,0,0,1,120,0c0,27.13,4.48,50,13.33,68Z"></path></svg>
        <span id="notificationDot" style="display:none;position:absolute;top:8px;right:28px;width:12px;height:12px;background:#e74c3c;border-radius:50%;z-index:2;"></span>
        <div class="item-label">é€šçŸ¥</div>
      </button>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      function checkUnreadNotifications() {
        if (!memberId) return;
        fetch(`/api/members/${memberId}/notifications`)
          .then(res => res.json())
          .then(data => {
            const hasUnread = data.some(n => n.is_read === false);
            document.getElementById('notificationDot').style.display = hasUnread ? 'block' : 'none';
          });
      }
      checkUnreadNotifications();
      setInterval(checkUnreadNotifications, 60000);
    });
    </script>

      <!-- å€‹äºº -->
      <button class="bottom-item">
        <svg xmlns="http://www.w3.org/2000/svg" width="96" height="96" fill="#000000" viewBox="0 0 256 256">
            <path d="M234.38,210a123.36,123.36,0,0,0-60.78-53.23,76,76,0,1,0-91.2,0A123.36,123.36,0,0,0,21.62,210a12,12,0,1,0,20.77,12c18.12-31.32,50.12-50,85.61-50s67.49,18.69,85.61,50a12,12,0,0,0,20.77-12ZM76,96a52,52,0,1,1,52,52A52.06,52.06,0,0,1,76,96Z"></path>
        </svg>
        <div class="item-label">å€‹äºº</div>
      </button>
    </div>

      <!-- æ´»å‹•é¡å‹é¸æ“‡å½ˆçª— -->
    <div id="activityTypeModal" class="activity-type-modal">
      <div class="activity-type-box">
        <div class="activity-type-title">
          é¸æ“‡æ´»å‹•é¡å‹
          <!-- å•è™Ÿ SVG -->
         <svg id="typeInfoBtn" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#4aa3b5" viewBox="0 0 256 256" style="position: relative; top: 3px;">
          <path d="M144,180a16,16,0,1,1-16-16A16,16,0,0,1,144,180Zm92-52A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128ZM128,64c-24.26,0-44,17.94-44,40v4a12,12,0,0,0,24,0v-4c0-8.82,9-16,20-16s20,7.18,20,16-9,16-20,16a12,12,0,0,0-12,12v8a12,12,0,0,0,23.73,2.56C158.31,137.88,172,122.37,172,104,172,81.94,152.26,64,128,64Z"/>
        </svg>
        </div>

        <div class="activity-type-options">
          <!-- ä¸€èˆ¬æ´»å‹• -->
          <button class="activity-type-btn" onclick="goToCreateWithType('general')">
            <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="#2c4975" viewBox="0 0 256 256">
              <path d="M253.88,108.11l-25.53-51a20,20,0,0,0-26.83-9L178.34,59.7,131.7,44.58a12.14,12.14,0,0,0-7.4,0L77.66,59.7,54.48,48.11a20,20,0,0,0-26.83,9L2.12,108.11a20,20,0,0,0,9,26.83l26.67,13.34,51.18,37.41A12.15,12.15,0,0,0,93,187.62l62,16a12.27,12.27,0,0,0,3,.38,12,12,0,0,0,8.48-3.52l52.62-52.62,25.83-12.92a20,20,0,0,0,8.95-26.83Zm-58.12,29.15-27.52-26a12,12,0,0,0-16.76.26c-9.66,9.74-25.06,16.81-40.81,9.55l38.19-37h22.72l25.81,51.63ZM47.32,71.37,60.59,78l-22,43.9-13.27-6.63Zm107,107.3L101.23,165l-42-30.66L85.17,82.5,128,68.61l1.69.55L90,107.68l-.13.12a20,20,0,0,0,3.4,31c20.95,13.39,46,12.07,66.33-2.73l19.2,18.15Zm63-56.77-22-43.9,13.27-6.63,21.95,43.9ZM118.55,219a12,12,0,0,1-14.62,8.62l-26.6-6.87a12,12,0,0,1-4.08-1.93L48.92,201a12,12,0,0,1,14.16-19.37l22.47,16.42,24.38,6.29A12,12,0,0,1,118.55,219Z"/>
            </svg>

            <div>ä¸€èˆ¬æ´»å‹•</div>
          </button>

          <!-- è¨“ç·´èª²ç¨‹ -->
          <button class="activity-type-btn" data-type="course" onclick="goToCreateWithType('course')">
            <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 256 256">
              <path d="M172,164a12,12,0,0,1-12,12H96a12,12,0,0,1,0-24h64A12,12,0,0,1,172,164Zm-12-52H96a12,12,0,0,0,0,24h64a12,12,0,0,0,0-24Zm60-64V216a20,20,0,0,1-20,20H56a20,20,0,0,1-20-20V48A20,20,0,0,1,56,28H90.53a51.88,51.88,0,0,1,74.94,0H200A20,20,0,0,1,220,48ZM100.29,60h55.42a28,28,0,0,0-55.42,0ZM196,52H178.59A52.13,52.13,0,0,1,180,64v8a12,12,0,0,1-12,12H88A12,12,0,0,1,76,72V64a52.13,52.13,0,0,1,1.41-12H60V212H196Z"/>
            </svg>
            <div>è¨“ç·´èª²ç¨‹</div>
          </button>

        </div>
      </div>
    </div>
      <!-- èªªæ˜å½ˆçª— -->
      <div id="typeInfoModal" class="modal" style="display:none;">
        <div class="modal-content">
          <h2>æ´»å‹•é¡å‹èªªæ˜</h2>
          <div class="scrollable-content">
            <h3>ä¸€èˆ¬æ´»å‹•</h3>
            <ul>
              <li>å…è²»å»ºç«‹ï¼Œé©åˆè‡¨æ™‚æªåœ˜æˆ–å–®æ¬¡æ´»å‹•</li>
              <li>å¿«é€Ÿç™¼ä½ˆã€ç°¡æ˜“å ±å</li>
            </ul>
            <h3>è¨“ç·´èª²ç¨‹ <span class="info-tag">ï¼ˆä»˜è²»æœƒå“¡é™å®šï¼‰</span></h3>
            <ul>
              <li>æ”¯æ´å–®å ‚ / å¤šå ‚æ’ç¨‹</li>
              <li>å®Œæ•´èª²ç¨‹ç®¡ç†</li>
            </ul>
          </div>
          <button class="modal-close-btn" onclick="closeTypeInfo()">é—œé–‰</button>

        </div>
      </div>
      <div id="upgradeModal" class="modal" style="display:none;">
        <div class="modal-content">
          <h3 class="dialog-title">è§£é–è¨“ç·´èª²ç¨‹</h3>
          <p class="dialog-desc">
            è§£é–ç‚ºä»˜è²»ç™¼èµ·äººï¼Œå³å¯å»ºç«‹è¨“ç·´èª²ç¨‹
          </p>
          <div class="dialog-actions">
            <button class="btn btn-outline-pink" onclick="closeUpgrade()">å–ã€€ã€€æ¶ˆ</button>
            <button class="btn btn-pink" onclick="goToMembership()">ç«‹å³é–‹é€š</button>
          </div>
        </div>
      </div>


    <script>
      let isPaidMember = false;

      const urlParams = new URLSearchParams(window.location.search);
      const memberId = urlParams.get("member_id");
      function twWeekday(d){ return ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'][d.getDay()]; }
      function pad2(n){ return String(n).padStart(2,'0'); }

      function switchTab(index) {
        const tabs = document.querySelectorAll(".tab");
        const contents = document.querySelectorAll(".tab-content");
        const indicator = document.getElementById("indicator");

        tabs.forEach((tab, i) => {
          tab.classList.toggle("active", i === index);
        });

        contents.forEach((content, i) => {
          content.style.display = i === index ? "block" : "none";
        });

        const tabWidth = tabs[0].offsetWidth;
        indicator.style.width = tabWidth + "px";
        indicator.style.left = tabWidth * index + "px";
      }

      function goToCreate() {
        if (!memberId) {
          alert("ç„¡æ•ˆçš„æœƒå“¡è³‡è¨Šï¼");
          return;
        }
        window.location.href = `/create_activity?member_id=${memberId}`;
      }

      function goToPage() {
        window.location.href = `/home?member_id=${memberId}`;
      }
      function goToActivity() {
        window.location.href = `/activity?member_id=${memberId}`;
      }


      function goToProfile() {
        window.location.href = `/member_view?member_id=${memberId}`;
      }

      function goToNews() {
        window.location.href = `/notice?member_id=${memberId}`;
      }


      window.addEventListener("resize", () => {
        const tabs = document.querySelectorAll(".tab");
        const activeIndex = [...tabs].findIndex((tab) =>
          tab.classList.contains("active")
        );
        const indicator = document.getElementById("indicator");
        const tabWidth = tabs[0].offsetWidth;
        indicator.style.width = tabWidth + "px";
        indicator.style.left = tabWidth * activeIndex + "px";
      });

      async function loadMyActivities() {
        if (!memberId) {
          document.getElementById("my-activities").innerText = "ç„¡æ•ˆçš„æœƒå“¡è³‡è¨Š";
          return;
        }

        try {
          const res = await fetch(`/api/activities/my?member_id=${memberId}`);
          let data = await res.json();

          const container = document.getElementById("my-activities");
          container.innerHTML = "";

          const cardContainer = document.createElement("div");
          cardContainer.className = "activity-card-container";

          // æ–°å¢æŒ‰éˆ•å¡ç‰‡
          const addActivityCard = document.createElement("div");
          addActivityCard.className = "activity-card add-activity-card";
          addActivityCard.onclick = openActivityTypeModal;
          addActivityCard.innerHTML = '<span class="plus-sign">ï¼‹</span>';


          cardContainer.appendChild(addActivityCard);

          if (data.length === 0) {
            container.innerText = "å°šæœªç™¼èµ·ä»»ä½•æ´»å‹•";
            container.appendChild(cardContainer); // ç¢ºä¿æŒ‰éˆ•å¡ç‰‡ä»ç„¶é¡¯ç¤º
            return;
          }

          // æŒ‰é–‹å§‹æ™‚é–“æ’åºï¼Œæ–°çš„åœ¨å‰ï¼ŒèˆŠçš„åœ¨å¾Œ
          data.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));

          data.forEach((activity) => {
            const card = document.createElement("div");
            card.className = "activity-card";

            // âœ… åªæœ‰ã€Œè¨“ç·´èª²ç¨‹ã€ä¸” organizer_has_discount = true æ‰é¡¯ç¤ºæŠ˜è§’
            const isTraining = (activity.type === 'class' || activity.type === 'muti_class');
            const discountCorner = (isTraining && activity.organizer_participated)
              ? `
                <span class="discount-corner">
                  <svg class="discount-corner__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" aria-hidden="true">
                    <path d="M208.49,64.47l-144,144a12,12,0,1,1-17-17l144-144a12,12,0,0,1,17,17ZM47.72,104.27A40,40,0,1,1,76,116,39.72,39.72,0,0,1,47.72,104.27ZM60,76a16,16,0,1,0,4.69-11.31A15.87,15.87,0,0,0,60,76ZM220,180a40,40,0,1,1-11.72-28.29A39.71,39.71,0,0,1,220,180Zm-24,0a15.87,15.87,0,0,0-4.69-11.32h0A16,16,0,1,0,196,180Z" fill="white"/>
                  </svg>
                </span>`
              : "";


            const now = new Date();
            const signupDeadline = new Date(activity.registration_deadline);
            const startTime = new Date(activity.start_time);
            const endTime = new Date(activity.end_time);

            let statusText = "å¯©æ ¸éšæ®µ"; // é è¨­
            if (now < signupDeadline) {
              statusText = "å¯©æ ¸éšæ®µ";
            } else if (now >= signupDeadline && now < startTime) {
              statusText = "æº–å‚™ä¸­";
            } else if (now >= startTime && now <= endTime) {
              statusText = "é€²è¡Œä¸­";
            } else if (now > endTime) {
              statusText = "å·²çµæŸ";
            }

            card.innerHTML = `
                ${discountCorner}  <!-- ğŸ‘ˆ æŠ˜è§’æ”¾æœ€å‰é¢ -->
                <div class="custom-card-header">
                  <h3 class="custom-card-title">${activity.title}</h3>
                  <span class="status-badge" style="background-color:#fda7a8;">
                    ${statusText}
                  </span>
                </div>

            


               <p class="custom-card-info">
                ${activity.sport_name} ï½œ ${activity.level ? activity.level : 'ç­‰ç´š'} ï½œ ç”± ${activity.organizer.name || 'æœªçŸ¥'} ç™¼èµ·
              </p>



              <p class="custom-card-icon-line"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#2c4975" viewBox="0 0 256 256"><path d="M128,64a40,40,0,1,0,40,40A40,40,0,0,0,128,64Zm0,64a24,24,0,1,1,24-24A24,24,0,0,1,128,128Zm0-112a88.1,88.1,0,0,0-88,88c0,31.4,14.51,64.68,42,96.25a254.19,254.19,0,0,0,41.45,38.3,8,8,0,0,0,9.18,0A254.19,254.19,0,0,0,174,200.25c27.45-31.57,42-64.85,42-96.25A88.1,88.1,0,0,0,128,16Zm0,206c-16.53-13-72-60.75-72-118a72,72,0,0,1,144,0C200,161.23,144.53,209,128,222Z"></path></svg> ${activity.location_name}</p>

              <p class="custom-card-icon-line">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#2c4975" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"></path></svg>  ${
                activity.start_time && activity.end_time
                    ? (() => {
                        const s = new Date(activity.start_time);
                        const e = new Date(activity.end_time);
                        const md = `${s.getMonth()+1}/${s.getDate()}`;
                        const wk = `ï¼ˆ${twWeekday(s)}ï¼‰`;  // â† åªé¡¯ç¤ºã€Œä¸€ï½æ—¥ã€
                        const st = `${pad2(s.getHours())}:${pad2(s.getMinutes())}`;
                        const et = `${pad2(e.getHours())}:${pad2(e.getMinutes())}`;
                        return `${md} ${wk} ${st} - ${et}`;
                      })()
                    : 'æœªè¨­å®š'
                }
              </p>

              <p class="custom-card-icon-line">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#2c4975" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm40-68a28,28,0,0,1-28,28h-4v8a8,8,0,0,1-16,0v-8H104a8,8,0,0,1,0-16h36a12,12,0,0,0,0-24H116a28,28,0,0,1,0-56h4V72a8,8,0,0,1,16,0v8h16a8,8,0,0,1,0,16H116a12,12,0,0,0,0,24h24A28,28,0,0,1,168,148Z"></path></svg> ${activity.venue_fee === 0 ? 'å…è²»' : activity.venue_fee} ï½œ   <span class="custom-card-tag ${
    (activity.type === 'class' || activity.type === 'muti_class') ? 'training' : 'general'
  }">${
                    activity.type === 'class'
                      ? 'è¨“ç·´èª²ç¨‹ï½œå–®å ‚'
                      : (activity.type === 'muti_class'
                          ? `è¨“ç·´èª²ç¨‹ï½œå…± ${activity.count ?? '?'} å ‚`
                          : 'ä¸€èˆ¬æ´»å‹•'
                        )
                  }
        </span>
              </p>

            `;
                    
           card.addEventListener("click", () => {
    window.location.href = `/api/activities/created_details_page?id=${activity.activity_id}${memberId ? `&member_id=${memberId}` : ''}`;
});
            cardContainer.appendChild(card);
          });

          container.appendChild(cardContainer);
        } catch (error) {
          document.getElementById("my-activities").innerText =
            "è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
          console.error(error);
        }
      }

      async function loadJoinedActivities() {
        if (!memberId) {
          document.getElementById("content-1").innerText = "ç„¡æ•ˆçš„æœƒå“¡è³‡è¨Š";
          return;
        }

        try {
          const res = await fetch(
            `/api/activities/joined?member_id=${memberId}`
          );
          const data = await res.json();

          const container = document.getElementById("content-1");
          container.innerHTML = "";

          if (data.length === 0) {
            container.innerText = "å°šæœªåƒåŠ ä»»ä½•æ´»å‹•";
            return;
          }

          const cardContainer = document.createElement("div");
          cardContainer.className = "activity-card-container";

          data.forEach((activity) => {
            const card = document.createElement("div");
            card.className = "activity-card";
            const now = new Date();
            const signupDeadline = new Date(activity.registration_deadline);
            const startTime = new Date(activity.start_time);
            const endTime = new Date(activity.end_time);

            let statusText = "å·²å ±å"; // é è¨­ â†’ ä»£è¡¨å·²å¯©æ ¸é€šé
            if (now < signupDeadline) {
              statusText = "å·²å ±å";
            } else if (now >= signupDeadline && now < startTime) {
              statusText = "æº–å‚™ä¸­";
            } else if (now >= startTime && now <= endTime) {
              statusText = "é€²è¡Œä¸­";
            } else if (now > endTime) {
              statusText = "å·²çµæŸ";
            }
            card.innerHTML = `
        <div class="custom-card-header">
            <h3 class="custom-card-title">${activity.title}</h3>
            <span class="status-badge">${statusText}</span>
          </div>
          <p class="custom-card-info">
            ${activity.sport_name} ï½œ ${activity.level ? activity.level : 'ç­‰ç´š'} ï½œ ç”± ${activity.organizer.name || 'æœªçŸ¥'} ç™¼èµ·
          </p>

          <p class="custom-card-icon-line"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#2c4975" viewBox="0 0 256 256"><path d="M128,64a40,40,0,1,0,40,40A40,40,0,0,0,128,64Zm0,64a24,24,0,1,1,24-24A24,24,0,0,1,128,128Zm0-112a88.1,88.1,0,0,0-88,88c0,31.4,14.51,64.68,42,96.25a254.19,254.19,0,0,0,41.45,38.3,8,8,0,0,0,9.18,0A254.19,254.19,0,0,0,174,200.25c27.45-31.57,42-64.85,42-96.25A88.1,88.1,0,0,0,128,16Zm0,206c-16.53-13-72-60.75-72-118a72,72,0,0,1,144,0C200,161.23,144.53,209,128,222Z"></path></svg> ${activity.location_name}</p>

          <p class="custom-card-icon-line">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#2c4975" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm64-88a8,8,0,0,1-8,8H128a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v48h48A8,8,0,0,1,192,128Z"></path></svg> ${
            activity.start_time && activity.end_time
                ? (() => {
                    const s = new Date(activity.start_time);
                    const e = new Date(activity.end_time);
                    const md = `${s.getMonth()+1}/${s.getDate()}`;
                    const wk = `ï¼ˆ${twWeekday(s)}ï¼‰`;  // â† åªé¡¯ç¤ºã€Œä¸€ï½æ—¥ã€
                    const st = `${pad2(s.getHours())}:${pad2(s.getMinutes())}`;
                    const et = `${pad2(e.getHours())}:${pad2(e.getMinutes())}`;
                    return `${md} ${wk} ${st} - ${et}`;
                  })()
                : 'æœªè¨­å®š'
            }
          </p>

          <p class="custom-card-icon-line">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#2c4975" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm40-68a28,28,0,0,1-28,28h-4v8a8,8,0,0,1-16,0v-8H104a8,8,0,0,1,0-16h36a12,12,0,0,0,0-24H116a28,28,0,0,1,0-56h4V72a8,8,0,0,1,16,0v8h16a8,8,0,0,1,0,16H116a12,12,0,0,0,0,24h24A28,28,0,0,1,168,148Z"></path></svg>
            ${(() => {
                  if (activity.venue_fee === 0) {
                    return `å…è²» ï½œ <span class="custom-card-tag general">ä¸€èˆ¬æ´»å‹•</span>`;
                  }
                  const isTraining = (activity.type === 'class' || activity.type === 'muti_class');
                if (isTraining && isPaidMember && activity.organizer_participated) {
                  const newPrice = Math.round(activity.venue_fee * 0.8); // 8æŠ˜
                  return `
                    <span class="price-and-tag">
                      <span class="price-wrapper">
                        <span class="original-price">${activity.venue_fee} å…ƒ</span>
                        <span class="discount-price">${newPrice} å…ƒ</span>
                      </span>
                      <span style="margin: 0 -10px;">ï½œ</span>
                      <span class="custom-card-tag training">
                        ${activity.type === 'class'
                          ? 'è¨“ç·´èª²ç¨‹ï½œå–®å ‚'
                          : `è¨“ç·´èª²ç¨‹ï½œå…± ${activity.count ?? '?'} å ‚`}
                      </span>
                    </span>
                  `;
                } else if (isTraining) {
                  return `
                    ${activity.venue_fee} å…ƒ ï½œ 
                    <span class="custom-card-tag training">
                      ${activity.type === 'class'
                        ? 'è¨“ç·´èª²ç¨‹ï½œå–®å ‚'
                        : `è¨“ç·´èª²ç¨‹ï½œå…± ${activity.count ?? '?'} å ‚`}
                    </span>
                  `;
                }

                  // ä¸€èˆ¬æ´»å‹•
                  return `
                    ${activity.venue_fee} å…ƒ ï½œ 
                    <span class="custom-card-tag general">ä¸€èˆ¬æ´»å‹•</span>
                  `;
              })()}
            </p>


        `;
card.addEventListener("click", () => {
    window.location.href = `/api/activities/joined_details_page?id=${activity.activity_id}${memberId ? `&member_id=${memberId}` : ''}`;
});
            cardContainer.appendChild(card);
          });

          container.appendChild(cardContainer);
        } catch (error) {
          document.getElementById("content-1").innerText =
            "è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
          console.error(error);
        }
      }

      let currentActivityId = null;

      window.onload = function () {
        switchTab(0);
        loadMyActivities();
        loadJoinedActivities(); // æ–°å¢è¼‰å…¥ã€Œæˆ‘åƒåŠ çš„æ´»å‹•ã€
      };
    </script>
    <script>
      document.querySelectorAll(".bottom-item").forEach((item) => {
      item.addEventListener("click", function (e) {
        e.preventDefault(); // âœ… é˜»æ­¢ç«‹å³è·³é 

        // ç§»é™¤èˆŠ rippleï¼ˆç¢ºä¿åªæœ‰ä¸€å€‹ï¼‰
        const oldRipple = this.querySelector(".ripple");
        if (oldRipple) oldRipple.remove();

        // å»ºç«‹æ–° ripple
        const ripple = document.createElement("span");
        ripple.classList.add("ripple");

        const rect = this.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        ripple.style.width = ripple.style.height = `${size * 2}px`;
        ripple.style.left = `${e.clientX - rect.left - size}px`;
        ripple.style.top = `${e.clientY - rect.top - size}px`;

        this.appendChild(ripple);

        // åˆ‡æ› active æ¨£å¼
        document.querySelectorAll(".bottom-item").forEach((i) =>
          i.classList.remove("active")
        );
        this.classList.add("active");

        // âœ… å»¶é²å°é ï¼šä¾ç…§é †åºå‘¼å«å°æ‡‰å‡½å¼
        const index = [...document.querySelectorAll(".bottom-item")].indexOf(this);
        setTimeout(() => {
          if (index === 0) goToPage();        // åœ°åœ–
          else if (index === 1) goToActivity(); // æ´»å‹•
          else if (index === 2) goToNews();     // é€šçŸ¥ï¼Œæš«æ™‚ä¸å°é 
          else if (index === 3) goToProfile(); // å€‹äºº
        }, 300);
      });
    });
      function openActivityTypeModal() {
      console.log("å½ˆçª—è§¸ç™¼äº†");
      document.getElementById("activityTypeModal").classList.add("show");
    }

    function closeActivityTypeModal() {
      document.getElementById("activityTypeModal").classList.remove("show");
    }

    function goToCreateWithType(type) {
      if (!memberId) {
        alert("ç„¡æ•ˆçš„æœƒå“¡è³‡è¨Šï¼");
        return;
      }

      if (type === 'general') {
        window.location.href = `/create_activity?member_id=${memberId}`;
      } else if (type === 'course') {
        window.location.href = `/create_class?member_id=${memberId}`;
      }
    }



    // é»æ“Šå½ˆçª—å¤–éƒ¨å€åŸŸæ™‚é—œé–‰å½ˆçª—
    document.getElementById("activityTypeModal").addEventListener("click", function (event) {
    const box = this.querySelector(".activity-type-box");
    if (!box.contains(event.target)) {
      this.classList.remove("show");
    }
  });


  // ğŸ”§ æ”¹ç‚ºå‹•æ…‹å¾ API å–å¾—æœƒå“¡è¨‚é–±ç‹€æ…‹

    if (memberId) {
      fetch(`/api/members/${memberId}`)
        .then(res => res.json())
        .then(data => {
          if (data.is_subscribed !== undefined) {
            isPaidMember = data.is_subscribed;
          }
          updateMemberUI();
        })
        .catch(() => {
          isPaidMember = false;
          updateMemberUI();
        });
    } else {
      updateMemberUI();
    }

    function updateMemberUI() {
      // ä¾ isPaidMember æ§åˆ¶ UI
      const courseBtn = document.querySelector('.activity-type-btn[data-type="course"]');
      if (courseBtn){
        if (!isPaidMember){
          courseBtn.classList.add('is-locked');
          if (!courseBtn.querySelector('.lock-pill')) {
            courseBtn.insertAdjacentHTML('afterbegin','<span class="lock-pill">ä»˜è²»æœƒå“¡é™å®š</span>');
          }
          const intercept = (e) => { e.preventDefault(); e.stopPropagation(); openUpgrade(); };
          courseBtn.addEventListener('click', intercept, true);
          courseBtn.setAttribute('aria-disabled','true');
          courseBtn.setAttribute('title','ä»˜è²»æœƒå“¡é™å®š');
        } else {
          courseBtn.classList.remove('is-locked');
          const pill = courseBtn.querySelector('.lock-pill'); if (pill) pill.remove();
          const clone = courseBtn.cloneNode(true);
          courseBtn.parentNode.replaceChild(clone, courseBtn);
        }
      }
    }

    // --- å•è™Ÿèªªæ˜ ---
    function openTypeInfo(){ document.getElementById('typeInfoModal').style.display='flex'; }
    function closeTypeInfo(){ document.getElementById('typeInfoModal').style.display='none'; }

    // --- å‡ç´šæç¤º ---
    function openUpgrade(){
      // ä¸é—œæ‰é¸æ“‡æ´»å‹•é¡å‹å½ˆçª—ï¼Œç›´æ¥æŠŠå‡ç´šæç¤ºé¡¯ç¤ºåœ¨ä¸Šå±¤
      document.getElementById('upgradeModal').style.display = 'flex';
    }
    function closeUpgrade(){ document.getElementById('upgradeModal').style.display='none'; }
    function goToMembership(){
      window.location.href = `/payment?member_id=${memberId}`;
      
    }

    document.addEventListener('DOMContentLoaded', () => {
      // å•è™Ÿï¼šé–‹èªªæ˜
      const infoBtn = document.getElementById('typeInfoBtn');
      if (infoBtn){
        infoBtn.addEventListener('click', openTypeInfo);
        infoBtn.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' ') openTypeInfo(); });
      }

      // è¨“ç·´èª²ç¨‹ï¼šä¾æœƒå“¡ç‹€æ…‹æ§åˆ¶ï¼ˆå–ä»£åŸæœ¬é‚£æ®µï¼‰
      const courseBtn = document.querySelector('.activity-type-btn[data-type="course"]');
      if (courseBtn){
        if (!isPaidMember){
          // å¤–è§€é–å®šï¼ˆéœ€è¦ä½ æœ‰åŠ ç¬¬1æ­¥çš„ .is-locked CSSï¼‰
          courseBtn.classList.add('is-locked');

          // å‹•æ…‹åŠ è† å›Šï¼ˆé¿å…é‡è¤‡ï¼‰
          if (!courseBtn.querySelector('.lock-pill')) {
            courseBtn.insertAdjacentHTML('afterbegin','<span class="lock-pill">ä»˜è²»æœƒå“¡é™å®š</span>');
          }

          // æ””æˆªé»æ“Šï¼Œæ”¹ç‚ºé–‹å‡ç´šè¦–çª—ï¼ˆç”¨æ•ç²éšæ®µæ“‹ä½ inline onclickï¼‰
          const intercept = (e) => { e.preventDefault(); e.stopPropagation(); openUpgrade(); };
          courseBtn.addEventListener('click', intercept, true);

          courseBtn.setAttribute('aria-disabled','true');
          courseBtn.setAttribute('title','ä»˜è²»æœƒå“¡é™å®š');
        } else {
          // å·²é–‹é€šï¼šè§£é™¤é–å®š
          courseBtn.classList.remove('is-locked');
          const pill = courseBtn.querySelector('.lock-pill'); if (pill) pill.remove();

          // ç§»é™¤ä»»ä½•æ•ç²ç›£è½ï¼Œä¿ç•™åŸæœ¬ onclick="goToCreateWithType('course')"
          const clone = courseBtn.cloneNode(true);
          courseBtn.parentNode.replaceChild(clone, courseBtn);
        }
      }
    });
    // é»å½ˆçª—å¤–é—œé–‰ï¼ˆæ²¿ç”¨ä½ çš„å¯«æ³•ï¼Œé¡å¤–åŠ åœ¨å…©å€‹æ–° modal ä¸Šï¼‰
    ['typeInfoModal','upgradeModal'].forEach(id=>{
      const el = document.getElementById(id);
      if (!el) return;
      el.addEventListener('click', function(e){
        const content = this.querySelector('.modal-content');
        if (content && !content.contains(e.target)) this.style.display = 'none';
      });
    });
    </script>    
  </body>
</html>
